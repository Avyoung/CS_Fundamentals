# 处理机调度
## 高级调度
又称为作业调度或长程调度

主要功能是根据某种算法，把外存上处于后背队列中的作业调入内存，并为它们创建进程，分配必要的资源，然后再讲新创建的进程插入就绪队列，准备执行。调度对象是作业。

### 作业
作业不仅包含了通常的程序和数据，还应配有一份作业说明书，系统根据作业说明书来对程序的运行进行控制。

作业控制块，作业在系统中存在的标志。

## 低级调度
又称为进程调度或短程调度

用于决定就绪队列中的哪个进程应获得处理机，然后再由分派程序执行把处理机分配给该进程的具体操作。

### 非抢占方式
一旦处理机分配给某进程后，不管它要运行多长时间，都一直让它运行下去，不允许其它进程抢占，直至该进程完成，自愿释放处理机，或发生某事件而被阻塞时，才再把处理机分配给其它进程。

采用非抢占调度方式时，可能引起进程调度的因素归纳如下：

1. 正在执行的进程执行完毕，或因发生某事件而不能继续执行。
2. 执行中的进程因提出I/O请求而暂停执行
3. 在进程通信或同步过程中执行了某种原语操作，如P操作，Block操作，Wakeup操作。

实现简单，系统开销小，适用于大多数批处理系统，但是难以满足紧急任务的要求---立即执行，不适合实时系统。

### 抢占方式
允许调度程序根据某种原则去暂停某个正在执行的进程，将已分配给该进程的处理机重新分配给另一进程。

优点是可以防止一个长进程长时间占用处理机。但是比非抢占式的开销大。

抢占调度方式是基于一定原则的，主要有如下几条：

1. 优先权原则
2. 短作业（进程）优先原则
3. 时间片原则

## 中级调度
又称中程调度

使那些暂时不能运行的进程不再占用宝贵的内存资源，而将它们调至外存上去等待，此时的进程状态为挂起状态或就绪驻外存状态。当这些进程重又具备运行条件且内存又稍有空闲时，由中级调度来决定把外存上的那些又具备运行条件的就绪进程重新调入内存，并修改其状态为就绪状态，挂在就绪队列上等待进程调度。

***周转时间***: 指从作业被提交给系统开始，到作业完成为止的这段时间间隔。包括四个部分：作业在外寸后备队列上等待（作业）调度的时间，进程在就绪队列上等待进程调度的时间，进程在CPU上执行的事件，以及进程等待I/O操作完成的时间。

***平均周转时间***：```T = （T1+T2+...+Tn）/ n```

***带权周转时间***：作业的周转时间与系统为它提供服务的时间之比 ```W = T / Ts```

***平均带权周转时间***:  ```(T1/Ts1+T2/Ts2+...+Tn/Tns) / n```

***截止时间***：指某任务必须开始执行的最迟时间，或必须完成的最迟时间。

***响应时间***：等待时间与服务时间的总和

***吞吐量***：指在单位时间内系统所完成的作业数。


# 调度算法
## 先来先服务（FCFS）调度
一种最简单的调度算法，即可用于作业调度，也可用于进程调度。

这种调度算法有利于长作业（进程），不利于短作业（进程）。有利于CPU繁忙型的作业，不利于I/O繁忙型的作业。

## 短作业（进程）优先调度
可以有效地降低作业的平均等待时间，提高系统吞吐量。

缺点：
* 对长作业不利
* 完全未考虑作业（进程）的紧迫程度，因为不能保证紧迫性作业（进程）会被及时处理。
* 作业（进程）的长短只是根据用户所提供的估计执行时间而定的，因此不一定能真正做到短作业优先。

## 高优先权优先调度
可用于作业调度，也可用于进程调度

分为抢占式优先权调度和非抢占式优先权调度

根据优先权的类型分为静态优先权，动态优先权

静态优先权是在创建进程时确定的，且在进程的整个运行过程期间保持不变。

动态优先权是指在创建进程时所赋予的优先权，是可以随进程的推进或随其等待时间的增加而改变的。

### 高响应比优先调度：
优先权 = 响应时间 / 服务时间

这种算法既照顾了短作业，又考虑了作业到达的先后次序，不会使长作业长期得不到服务，实现了一种较好的折中。但是，每次进行调度时，都需先做响应比的计算，增加了系统开销。

## 基于时间片的轮转调度
### 时间片轮转法
系统将所有的就绪进程按先来先服务的原则,排成一个队列,每次调度时,把CPU分配给队首进程,并令其执行一个时间片.时间片的大小从几ms到几百ms.当执行的时间片用完时,由一个计时器发出时钟中断请求,调度程序便据此信号来停止该进程的执行,并将它送往就绪队列的末尾;然后,再把处理机分配给就绪队列中新的队首进程,同时也让它执行一个时间片.这样就可以保证就绪队列中的所有进程,在一给定的时间内,均能获得一时间片的处理机执行时间.

### 多级反馈队列调度
* 设置多个队列，各个队列优先级和时间片长短都不同，优先级由高到低，时间片长短逐渐增长，
* 当一个新进程进入内存后，首先将它放在第一队列的队尾，按照FCFS原则排队等待调度。当轮到该进程执行时，如果能在该时间片内完成，则准备撤离系统，否则将该进程转入到第二队列的队尾，以此类推。
* 仅当第一队列空闲时，调度程序才调度第二队列中的进程，以此类推。如果处理机正在第i队列中为某进程服务时，又有新进程进入优先级更高的队列，则此时新进程将抢占正在运行进程的处理机，即由调度程序把正在运行的进程放回第i队列的末尾，把处理机分配给新到的高优先级进程。
